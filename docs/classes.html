<html>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
      <div class="mermaid">
    
        classDiagram
          class BDScore {
            alpha : float
            graph : Union[np.ndarray, nx.DiGraph]
            compute()
          }
          class BDeuScore {
            graph : Optional[Union[np.ndarray, nx.DiGraph]]
            compute(alpha: float)
          }
          class BGeScore {
            am
            parameters
            reg_coefficients
            compute()
            compute_BGe_with_edge(node: str, parents: list)
            compute_BGe_with_graph()
            compute_BGe_with_node(node: str)
            compute_node(node: str)
          }
          class GraphProposal {
            operations : list
            prob_Gcurr_Gprop
            prob_Gprop_Gcurr
            prob_Gcurr_Gprop_f()
            prob_Gprop_Gcurr_f()
            propose_DAG()
          }
          class MCMC {
            data
            initial_graph
            max_iter
            node_labels
            num_nodes
            proposal_object
            score_object
            run()*
          }
          class MarginalLogLikelihood {
            a : float
            b : float
            parameters : dict
            reg_coefficients : dict
            to_string
            compute()
            compute_marginal_log_likelihood_from_data()
            compute_marginal_log_likelihood_with_graph()
            compute_marginal_log_likelihood_with_node(node: str)
            compute_node(node)
            recover_regr_params(parameters: dict)
          }
          class OrderedPartition {
            all_nodes
            partitions
            size
            add_node_to_partition(part_indx: int, node: str)
            copy()
            find_node(node_label)
            get_all_nodes()
            get_all_nodes_adj_left(indx)
            get_all_nodes_adj_right(indx)
            get_all_nodes_from_left(indx)
            get_all_nodes_from_right(indx)
            get_partition_by_indx(index)
            get_partitions()
            info()
            insert_partition(part_id: int, nodes: set)
            join_partition(part_id: int)
            print_partitions()
            remove_empty_partitions()
            remove_node_from_partition(part_id: int, node: str)
            remove_partition(part_id)
            replace_partition(new_partition: Partition, index: int)
            update_IDs()
            visualize_partitions(fig_size, title)
          }
          class Partition {
            ID : int
            nodes
            size
            add_nodes(nodes: set)
            add_single_node(node: str)
            copy()
            get_ID()
            info()
            remove_nodes(nodes: set)
            remove_single_node(node: str)
            replace_partition(new_partition)
            set_ID(ID)
            visualize_partition(fig_size)
          }
          class PartitionMCMC {
            init_part
            mcmc_res : dict
            parent_table
            proposal_object
            score_table
            to_string : str
            get_mcmc_res_graphs(results)
            log_acceptance_ratio(chosen_move, score_P_curr, score_P_prop, neigh_size_curr, neigh_size_prop, nbh_join_prop, nbh_join_curr, nbh_create_prop, nbh_create_curr)
            log_acceptance_ratio_join_merge(neigh_size_curr, neigh_size_prop, score_P_curr, score_P_prop)
            log_acceptance_ratio_new_existing(nbh_join_prop, nbh_join_curr, nbh_create_prop, nbh_create_curr, score_P_curr, score_P_prop)
            log_acceptance_ratio_swap(score_P_curr, score_P_prop)
            run()
            to_string()
            update_MCMC_res(iteration, graph, partition, party, permy, posy, operation, isAccepted, score_P_curr, score_P_prop, acceptance_prob)
          }
          class PartitionProposal {
            MERGE_PARTITIONS : str
            MOVE_NODE_TO_EXISTING_PARTITION : str
            MOVE_NODE_TO_NEW_OR_EXISTING : str
            MOVE_NODE_TO_NEW_PARTITION : str
            SPLIT_OR_MERGE : str
            SPLIT_PARTITIONS : str
            STAY_STILL : str
            SWAP_ADJACENT : str
            SWAP_GLOBAL : str
            chosen_move : NoneType, str
            move_probs
            nbh
            nbh_create_new : NoneType
            nbh_join_existing : NoneType
            nbh_size
            nodes
            num_moves : int
            num_nodes
            num_part
            ordered_partition
            possible_moves : list
            to_rescore : set
            calculate_move_probs()
            compute_neighborhoods()
            get_chosen_move()
            get_nbh()
            get_nbh_create_new()
            get_nbh_join_existing()
            get_nbh_size()
            get_num_partitions()
            get_ordered_partition()
            get_to_rescore()
            join_move(idx: int)
            move_node_to_existing_or_new_partition()
            node_to_existing_partition()
            node_to_new_partition()
            propose_partition()
            set_chosen_move(move)
            set_nbh(nbh)
            set_nbh_create_new(nbh_create_new)
            set_nbh_join_existing(nbh_join_existing)
            set_nbh_size(nbh_size)
            set_num_partitions(num_part)
            set_ordered_partition(new_partition)
            set_to_rescore(to_rescore)
            split_move(idx: int)
            split_or_merge_move()
            swap_adjacent()
            swap_global()
            update_partition(new_partition)
          }
          class Score {
            adj_matrix
            data
            graph
            incidence
            is_log_space
            node_label_to_index
            node_labels
            to_string
            compute()*
            compute_node(node: str)*
          }
          class StructureLearningProposal {
            blacklist
            current_graph
            node_labels
            num_nodes
            operation
            proposed_graph
            whitelist
            prob_Gcurr_Gprop_f()*
            prob_Gprop_Gcurr_f()*
            propose_DAG()*
          }
          class StructureMCMC {
            current_graph
            incidence
            to_string
            acceptance_ratio(posterior_Gcurr: float, posterior_Gprop: float, Q_Gcurr_Gprop: float, Q_Gprop_Gcurr: float)
            get_mcmc_res_accepted_graphs(results)
            get_mcmc_res_graphs(results)
            get_mcmc_res_operations(results)
            get_mcmc_res_scores(results)
            log_acceptance_ratio(posterior_Gcurr: float, posterior_Gprop: float, Q_Gcurr_Gprop: float, Q_Gprop_Gcurr: float)
            run()
          }
          class SyntheticDataset {
            P
            W
            adj_mat : DataFrame
            data : DataFrame
            degree : float
            graph_type : str
            node_labels : list
            noise_scale : float
            num_nodes : float
            num_obs : float
            true_dag : NoneType
            w_range : tuple
            simulate_data(W, n, noise_scale, sigmas)
            simulate_data_V1(W, n, noise_scale, sigmas)
            simulate_data_from_dag(DAG: np.ndarray, num_obs, num_nodes, node_labels, w_range, noise_scale)
            simulate_gaussian_dag(d, w_std)
            simulate_random_dag(d, degree, graph_type, w_range)
          }
          class WeightedBGeScore {
            penalty_coefficient : float
            calculate_complexity_penalty()
            calculate_node_complexity_penalty(num_parents)
            compute_BGe_with_graph()
            compute_BGe_with_node(node: str)
          }
          PartitionMCMC --|> MCMC
          StructureMCMC --|> MCMC
          GraphProposal --|> StructureLearningProposal
          BDScore --|> Score
          BDeuScore --|> Score
          BGeScore --|> Score
          WeightedBGeScore --|> BGeScore
          MarginalLogLikelihood --|> Score
          PartitionProposal --* PartitionMCMC : proposal_object
          OrderedPartition --o PartitionMCMC : init_part
          Score --o MCMC : _score_object
  
       </div>
  </body>
</html>
