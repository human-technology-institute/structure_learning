<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><title>Python: module mcmc.evaluation.metrics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head><body bgcolor="#f0f0f8">

<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="heading">
<tr bgcolor="#7799ee">
<td valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial">&nbsp;<br><big><big><strong><a href="mcmc.html"><font color="#ffffff">mcmc</font></a>.<a href="mcmc.evaluation.html"><font color="#ffffff">evaluation</font></a>.metrics</strong></big></big></font></td
><td align=right valign=bottom
><font color="#ffffff" face="helvetica, arial"><a href=".">index</a><br><a href="file:/Users/165421/Documents/code/mcmc/evaluation/metrics.py">/Users/165421/Documents/code/mcmc/evaluation/metrics.py</a></font></td></tr></table>
    <p></p>
<p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#aa55cc">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Modules</strong></big></font></td></tr>
    
<tr><td bgcolor="#aa55cc"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><table width="100%" summary="list"><tr><td width="25%" valign=top><a href="sklearn.metrics.html">sklearn.metrics</a><br>
</td><td width="25%" valign=top><a href="numpy.html">numpy</a><br>
</td><td width="25%" valign=top><a href="pickle.html">pickle</a><br>
</td><td width="25%" valign=top></td></tr></table></td></tr></table><p>
<table width="100%" cellspacing=0 cellpadding=2 border=0 summary="section">
<tr bgcolor="#eeaa77">
<td colspan=3 valign=bottom>&nbsp;<br>
<font color="#ffffff" face="helvetica, arial"><big><strong>Functions</strong></big></font></td></tr>
    
<tr><td bgcolor="#eeaa77"><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt></td><td>&nbsp;</td>
<td width="100%"><dl><dt><a name="-compute_divergence"><strong>compute_divergence</strong></a>(self, interval=100, results_output_path=None)</dt></dl>
 <dl><dt><a name="-expected_edges_DAGFlows"><strong>expected_edges_DAGFlows</strong></a>(mcmc_graph_list)</dt><dd><tt>Compute&nbsp;the&nbsp;expected&nbsp;number&nbsp;of&nbsp;edges.<br>
&nbsp;<br>
This&nbsp;function&nbsp;computes&nbsp;the&nbsp;expected&nbsp;number&nbsp;of&nbsp;edges&nbsp;in&nbsp;graphs&nbsp;sampled&nbsp;from<br>
the&nbsp;posterior&nbsp;approximation.<br>
Code&nbsp;from:<br>
<a href="https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py">https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py</a><br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;mcmc_graph_list&nbsp;(list&nbsp;(numpy.ndarray)):&nbsp;&nbsp;Posterior&nbsp;approximation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;array&nbsp;must&nbsp;have&nbsp;size&nbsp;`(B,&nbsp;N,&nbsp;N)`,&nbsp;where&nbsp;`B`&nbsp;is&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;sample&nbsp;graphs&nbsp;from&nbsp;the&nbsp;posterior&nbsp;approximation,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;`N`&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;variables&nbsp;in&nbsp;the&nbsp;graphs.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;(float):&nbsp;The&nbsp;expected&nbsp;number&nbsp;of&nbsp;edges.</tt></dd></dl>
 <dl><dt><a name="-expected_shd_DAGFlows"><strong>expected_shd_DAGFlows</strong></a>(chain_list: list, true_DAG: numpy.ndarray)</dt><dd><tt>Compute&nbsp;the&nbsp;Expected&nbsp;Structural&nbsp;Hamming&nbsp;Distance.<br>
&nbsp;<br>
This&nbsp;function&nbsp;computes&nbsp;the&nbsp;Expected&nbsp;SHD&nbsp;between&nbsp;a&nbsp;posterior&nbsp;approximation<br>
given&nbsp;as&nbsp;a&nbsp;collection&nbsp;of&nbsp;samples&nbsp;from&nbsp;the&nbsp;posterior,&nbsp;and&nbsp;the&nbsp;ground-truth<br>
graph&nbsp;used&nbsp;in&nbsp;the&nbsp;original&nbsp;data&nbsp;generation&nbsp;process.<br>
Code&nbsp;from:<br>
<a href="https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py">https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py</a><br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;chain_list&nbsp;(list&nbsp;(numpy.ndarray)):&nbsp;&nbsp;Posterior&nbsp;approximation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;array&nbsp;must&nbsp;have&nbsp;size&nbsp;`(B,&nbsp;N,&nbsp;N)`,&nbsp;where&nbsp;`B`&nbsp;is&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;sample&nbsp;graphs&nbsp;from&nbsp;the&nbsp;posterior&nbsp;approximation,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;`N`&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;variables&nbsp;in&nbsp;the&nbsp;graphs.<br>
&nbsp;&nbsp;&nbsp;&nbsp;true_DAG&nbsp;(numpy.ndarray):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adjacency&nbsp;matrix&nbsp;of&nbsp;the&nbsp;ground-truth&nbsp;graph.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;array&nbsp;must&nbsp;have&nbsp;size&nbsp;`(N,&nbsp;N)`,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;`N`&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;variables&nbsp;in&nbsp;the&nbsp;graph.<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;(float):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;Expected&nbsp;SHD.</tt></dd></dl>
 <dl><dt><a name="-jensen_shannon_divergence"><strong>jensen_shannon_divergence</strong></a>(P: dict, Q: dict, epsilon: float = 1e-15)</dt><dd><tt>Compute&nbsp;the&nbsp;jensen_shannon_divergence&nbsp;between&nbsp;two&nbsp;distributions.<br>
Requires&nbsp;that&nbsp;the&nbsp;two&nbsp;distributions&nbsp;have&nbsp;the&nbsp;same&nbsp;length.</tt></dd></dl>
 <dl><dt><a name="-kl_divergence"><strong>kl_divergence</strong></a>(P: dict, Q: dict, epsilon: float = 1e-15)</dt><dd><tt>Computes&nbsp;the&nbsp;KL&nbsp;divergence&nbsp;between&nbsp;two&nbsp;distributions.<br>
Requires&nbsp;that&nbsp;the&nbsp;two&nbsp;distributions&nbsp;have&nbsp;the&nbsp;same&nbsp;length.</tt></dd></dl>
 <dl><dt><a name="-mean_absolute_error"><strong>mean_absolute_error</strong></a>(P: dict, Q: dict)</dt><dd><tt>Compute&nbsp;mean&nbsp;absolute&nbsp;error.</tt></dd></dl>
 <dl><dt><a name="-mean_squared_error"><strong>mean_squared_error</strong></a>(P: dict, Q: dict)</dt><dd><tt>Compute&nbsp;mean&nbsp;squared&nbsp;error.</tt></dd></dl>
 <dl><dt><a name="-pairwise_structural_hamming_distance"><strong>pairwise_structural_hamming_distance</strong></a>(x, y)</dt><dd><tt>Computes&nbsp;pairwise&nbsp;Structural&nbsp;Hamming&nbsp;distance,&nbsp;i.e.<br>
the&nbsp;number&nbsp;of&nbsp;edge&nbsp;insertions,&nbsp;deletions&nbsp;or&nbsp;flips&nbsp;in&nbsp;order&nbsp;to&nbsp;transform&nbsp;one&nbsp;graph&nbsp;to&nbsp;another<br>
This&nbsp;means,&nbsp;edge&nbsp;reversals&nbsp;do&nbsp;not&nbsp;double&nbsp;count,&nbsp;and&nbsp;that&nbsp;getting&nbsp;an&nbsp;undirected&nbsp;edge&nbsp;wrong&nbsp;only&nbsp;counts&nbsp;1<br>
&nbsp;<br>
Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;(numpy.ndarray):&nbsp;batch&nbsp;of&nbsp;adjacency&nbsp;matrices&nbsp;&nbsp;[N,&nbsp;d,&nbsp;d]<br>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;(numpy.ndarray):&nbsp;batch&nbsp;of&nbsp;adjacency&nbsp;matrices&nbsp;&nbsp;[M,&nbsp;d,&nbsp;d]<br>
&nbsp;<br>
Returns:<br>
&nbsp;&nbsp;&nbsp;&nbsp;(numpy.ndarray):&nbsp;matrix&nbsp;of&nbsp;shape&nbsp;``[N,&nbsp;M]``&nbsp;&nbsp;where&nbsp;elt&nbsp;``i,j``&nbsp;is&nbsp;&nbsp;SHD(``x[i]``,&nbsp;``y[j]``)</tt></dd></dl>
 <dl><dt><a name="-save_results"><strong>save_results</strong></a>(self, results, filename)</dt><dd><tt>Pickle&nbsp;results</tt></dd></dl>
 <dl><dt><a name="-threshold_metrics_DAGFlows"><strong>threshold_metrics_DAGFlows</strong></a>(mcmc_graph_list, true_DAG)</dt><dd><tt>Compute&nbsp;threshold&nbsp;metrics&nbsp;(e.g.&nbsp;AUROC,&nbsp;Precision,&nbsp;Recall,&nbsp;etc...).<br>
Code&nbsp;from:<br>
<a href="https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py">https://github.com/tristandeleu/jax-dag-gflownet/blob/master/dag_gflownet/utils/metrics.py</a><br>
&nbsp;<br>
&nbsp;Parameters:<br>
&nbsp;&nbsp;&nbsp;&nbsp;mcmc_graph_list&nbsp;(list&nbsp;(numpy.ndarray)):&nbsp;&nbsp;Posterior&nbsp;approximation.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;array&nbsp;must&nbsp;have&nbsp;size&nbsp;`(B,&nbsp;N,&nbsp;N)`,&nbsp;where&nbsp;`B`&nbsp;is&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;number&nbsp;of&nbsp;sample&nbsp;graphs&nbsp;from&nbsp;the&nbsp;posterior&nbsp;approximation,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;`N`&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;variables&nbsp;in&nbsp;the&nbsp;graphs.<br>
&nbsp;&nbsp;&nbsp;&nbsp;true_DAG&nbsp;(numpy.ndarray):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adjacency&nbsp;matrix&nbsp;of&nbsp;the&nbsp;ground-truth&nbsp;graph.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;array&nbsp;must&nbsp;have&nbsp;size&nbsp;`(N,&nbsp;N)`,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;`N`&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;variables&nbsp;in&nbsp;the&nbsp;graph.<br>
&nbsp;<br>
Returns<br>
-------<br>
&nbsp;&nbsp;&nbsp;&nbsp;(dict):&nbsp;threshold&nbsp;metrics.</tt></dd></dl>
</td></tr></table>
</body></html>